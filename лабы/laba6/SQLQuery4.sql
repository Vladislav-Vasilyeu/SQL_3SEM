USE Vas_MyBase;

SELECT 
    Клиенты.id_клиента,
    Клиенты.Наименование_фирмы_заказчика,
    ROUND(CAST(AVG(ТОВАРЫ.Цена * ЗАКАЗЫ.Количество) AS FLOAT), 2) AS [Средняя стоимость заказа]
FROM 
    ЗАКАЗЫ
INNER JOIN 
    ТОВАРЫ ON ЗАКАЗЫ.id_товара = ТОВАРЫ.id_товара
INNER JOIN 
    КЛИЕНТЫ ON ЗАКАЗЫ.id_клиента = КЛИЕНТЫ.id_клиента
WHERE ТОВАРЫ.Цена > 7000
GROUP BY 
    Клиенты.id_клиента, 
    Клиенты.Наименование_фирмы_заказчика;
